{"id":"tyr-0ql","title":"P1.4: Wire provider pipeline into tyr check","description":"Implement a provider pipeline runner and wire it into `tyr check`. The pipeline implements the full decision flow from SPEC.md:\n1. Parse `PermissionRequest`\n2. Check explicit denies via agent config -\u003e deny immediately if matched (this also serves as the hallucination guard for Phase 2 — denies are enforced before any provider runs, so no provider can override them)\n3. Run enabled providers in order (just chained-commands for now)\n4. First definitive result (`allow` or `deny`) wins\n5. No result / error -\u003e fall-through (empty output)\n\nThe pipeline runner should be reusable (P3.2 will prepend cache as a provider layer). Use the logging infrastructure from P05.2 to record the decision and which provider made it.\n\nTests: deny-listed command rejected before providers run, provider ordering respected, first-wins semantics, error -\u003e fall-through, logging records decision + provider.\n\nDepends on: P05.1, P05.2, P1.1, P1.3\nBlocks: P1.5, P2.1, P3.2","status":"closed","priority":1,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T08:11:33.630223-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-14T15:15:13.048224-06:00","closed_at":"2026-02-14T15:15:13.048224-06:00","close_reason":"Closed","dependencies":[{"issue_id":"tyr-0ql","depends_on_id":"tyr-33c","type":"blocks","created_at":"2026-02-14T08:11:36.128851-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-0ql","depends_on_id":"tyr-g33","type":"blocks","created_at":"2026-02-14T08:11:36.296493-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-0ql","depends_on_id":"tyr-t9c","type":"blocks","created_at":"2026-02-14T08:11:36.667288-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-0ql","depends_on_id":"tyr-10l","type":"blocks","created_at":"2026-02-14T08:11:37.008747-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-0ql","depends_on_id":"tyr-du6","type":"blocks","created_at":"2026-02-14T08:23:17.472634-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-0ro","title":"Code quality: address reviewer findings across TypeScript codebase","status":"closed","priority":3,"issue_type":"epic","owner":"panchal.rushy@gmail.com","created_at":"2026-02-15T21:41:49.325551-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-15T22:28:10.328402-06:00","closed_at":"2026-02-15T22:28:10.328402-06:00","close_reason":"All 16 subtask issues completed","dependencies":[{"issue_id":"tyr-0ro","depends_on_id":"tyr-ssx","type":"blocks","created_at":"2026-02-15T21:42:58.752648-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-0ro","depends_on_id":"tyr-7xa","type":"blocks","created_at":"2026-02-15T21:42:58.833577-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-0ro","depends_on_id":"tyr-np8","type":"blocks","created_at":"2026-02-15T21:42:58.913744-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-0ro","depends_on_id":"tyr-62s","type":"blocks","created_at":"2026-02-15T21:42:58.993059-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-0ro","depends_on_id":"tyr-dbx","type":"blocks","created_at":"2026-02-15T21:42:59.095298-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-0ro","depends_on_id":"tyr-cb2","type":"blocks","created_at":"2026-02-15T21:42:59.190312-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-0ro","depends_on_id":"tyr-yr0","type":"blocks","created_at":"2026-02-15T21:42:59.273167-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-0ro","depends_on_id":"tyr-dvf","type":"blocks","created_at":"2026-02-15T21:42:59.358507-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-0ro","depends_on_id":"tyr-8ty","type":"blocks","created_at":"2026-02-15T21:42:59.445866-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-0ro","depends_on_id":"tyr-4me","type":"blocks","created_at":"2026-02-15T21:42:59.534221-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-0ro","depends_on_id":"tyr-ac6","type":"blocks","created_at":"2026-02-15T21:42:59.617222-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-0ro","depends_on_id":"tyr-bda","type":"blocks","created_at":"2026-02-15T21:42:59.697486-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-0ro","depends_on_id":"tyr-l2l","type":"blocks","created_at":"2026-02-15T21:42:59.781127-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-0ro","depends_on_id":"tyr-cv8","type":"blocks","created_at":"2026-02-15T21:44:25.514209-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-0ro","depends_on_id":"tyr-5rz","type":"blocks","created_at":"2026-02-15T21:44:25.596149-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-0ro","depends_on_id":"tyr-pdh","type":"blocks","created_at":"2026-02-15T21:44:54.71502-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-10l","title":"P1.3: Chained commands provider","description":"Implement `src/providers/chained-commands.ts` satisfying the `Provider` interface. Uses the shell parser (P1.2) to split a command, then checks each sub-command against the Claude agent config (P1.1). If every sub-command is individually allowed -\u003e approve. If any is denied -\u003e deny. Otherwise -\u003e abstain.\n\nTests: all-allowed chain -\u003e approve, one-denied chain -\u003e deny, unknown command in chain -\u003e abstain, single command pass-through.\n\nDepends on: P1.1, P1.2\nBlocks: P1.4","status":"closed","priority":1,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T08:11:33.526418-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-14T15:11:28.59727-06:00","closed_at":"2026-02-14T15:11:28.59727-06:00","close_reason":"Closed","dependencies":[{"issue_id":"tyr-10l","depends_on_id":"tyr-t9c","type":"blocks","created_at":"2026-02-14T08:11:36.583996-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-10l","depends_on_id":"tyr-wfg","type":"blocks","created_at":"2026-02-14T08:11:36.923891-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-1hd","title":"make llm config nested / polymorphic","description":"instead of having llmModel, llmProvider, llmEndpoint as config, make it nested like llm: {model: ..., provider: ...}, and only ask for endpoint if the provider is openrouter","status":"open","priority":1,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-18T08:52:56.098522-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-18T08:52:56.098522-06:00"}
{"id":"tyr-1n0","title":"tyr suggest subcommand","description":"Implement tyr suggest [--apply] [--global|--project] [--min-count \u003cn\u003e]. Queries logs to find commands that are frequently auto-approved but not yet in Claude's allow list: (1) SELECT command, COUNT(*) FROM logs WHERE decision='allow' AND mode IS NULL GROUP BY command HAVING COUNT(*) \u003e= min_count ORDER BY COUNT(*) DESC. (2) Filter out commands already in Claude's allow rules (via ClaudeAgent). (3) Display suggestions with their approval count. (4) --apply writes new allow rules into Claude's settings.json (--global or --project). (5) --apply merges without clobbering existing rules. (6) Default (no --apply) is dry-run. Tests: suggestions based on frequency, already-allowed commands excluded, --apply merges correctly, dry-run has no side effects.","status":"closed","priority":0,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-18T01:15:19.48168-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-18T09:57:07.334699-06:00","closed_at":"2026-02-18T09:57:07.334699-06:00","close_reason":"Closed","dependencies":[{"issue_id":"tyr-1n0","depends_on_id":"tyr-tv7","type":"blocks","created_at":"2026-02-18T01:15:34.972074-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-1pr","title":"Design permission check prompt","description":"Design and document the system/user prompt sent to the LLM for permission classification. The prompt should include: the command being evaluated, the tool name, existing allow/deny patterns from Claude config, and instructions to respond with a JSON object containing the decision (allow/deny/abstain) and a brief reason. Keep the prompt minimal to reduce latency and token cost.","status":"closed","priority":3,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T21:22:52.399805-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-15T19:49:02.517725-06:00","closed_at":"2026-02-15T19:49:02.517725-06:00","close_reason":"Prompt was designed and implemented in buildPrompt() in src/providers/llm.ts - pattern-similarity checker framing"}
{"id":"tyr-1y7","title":"Phase 2: LLM Provider","description":"Use Claude (via subprocess) as a fallback provider for permission checks that chained-commands can't resolve.","status":"closed","priority":2,"issue_type":"epic","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T08:11:32.00172-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-15T18:51:27.741113-06:00","closed_at":"2026-02-15T18:51:27.741113-06:00","close_reason":"All Phase 2 subtasks completed: LLM provider, adversarial tests, and E2E tests","dependencies":[{"issue_id":"tyr-1y7","depends_on_id":"tyr-f81","type":"blocks","created_at":"2026-02-14T08:12:33.217485-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-1y7","depends_on_id":"tyr-g1o","type":"blocks","created_at":"2026-02-14T08:12:33.300616-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-1y7","depends_on_id":"tyr-au6","type":"blocks","created_at":"2026-02-14T08:12:33.384301-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-1zm","title":"P4.2: Decision metrics tracking","description":"Track counts: cache hits, LLM checks, denials, fall-throughs. Store in the durable cache file or alongside it. Calculate \"estimated user-effort saved\" (count of auto-approved requests).\n\nTests: counters increment correctly, metrics survive restart, effort calculation is accurate.\n\nDepends on: P4.1\nBlocks: P4.3","status":"closed","priority":3,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T08:11:34.548028-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-18T01:15:41.685434-06:00","closed_at":"2026-02-18T01:15:41.685434-06:00","close_reason":"Replaced by SQLite Storage Layer epic (tyr-6fb). Daemon approach replaced with direct SQLite access.","dependencies":[{"issue_id":"tyr-1zm","depends_on_id":"tyr-91f","type":"blocks","created_at":"2026-02-14T08:11:37.822003-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-27j","title":"Wire LLM provider into judge pipeline","description":"Update src/commands/judge.ts to instantiate the LLM provider when allowPromptChecks is true and OPENROUTER_API_KEY is set. Add it to the providers array after ChainedCommandsProvider so rule-based checks run first.","status":"closed","priority":3,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T21:22:45.406916-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-17T10:50:33.014193-06:00","closed_at":"2026-02-17T10:50:33.014193-06:00","close_reason":"Already completed as part of tyr-ewl: OpenRouter provider is wired into judge.ts and instantiated based on llmProvider config","dependencies":[{"issue_id":"tyr-27j","depends_on_id":"tyr-ewl","type":"blocks","created_at":"2026-02-14T21:22:56.98695-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-2kd","title":"P3.4: Phase 3 E2E tests","description":"End-to-end tests for the full Phase 3 flow using the subprocess helper from P0.6: spawn tyr daemon, then pipe PermissionRequest JSON into tyr check. Verify: cache miss on first request falls through to providers, second identical request is a cache hit (faster, same result), config change evicts affected cache entries, daemon stop/start preserves no state (in-memory only).\n\nDepends on: P0.6, P3.3\nBlocks: nothing","status":"closed","priority":3,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T08:27:50.873188-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-18T01:15:41.620489-06:00","closed_at":"2026-02-18T01:15:41.620489-06:00","close_reason":"Replaced by SQLite Storage Layer epic (tyr-6fb). Daemon approach replaced with direct SQLite access.","dependencies":[{"issue_id":"tyr-2kd","depends_on_id":"tyr-bzs","type":"blocks","created_at":"2026-02-14T08:27:55.788091-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-2kd","depends_on_id":"tyr-ox4","type":"blocks","created_at":"2026-02-14T08:27:55.870884-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-2zp","title":"P1.5: Phase 1 E2E tests","description":"End-to-end tests for the full Phase 1 flow using the subprocess helper from P0.6: pipe a realistic `PermissionRequest` JSON into `tyr check` via stdin, verify stdout output and exit code. Cover: allowed chained command, denied command, unknown command (fall-through), malformed input.\n\nDepends on: P0.6, P1.4\nBlocks: nothing","status":"closed","priority":2,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T08:11:33.73313-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-14T15:23:42.898942-06:00","closed_at":"2026-02-14T15:23:42.898942-06:00","close_reason":"Closed","dependencies":[{"issue_id":"tyr-2zp","depends_on_id":"tyr-bzs","type":"blocks","created_at":"2026-02-14T08:11:36.380835-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-2zp","depends_on_id":"tyr-0ql","type":"blocks","created_at":"2026-02-14T08:11:37.09435-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-33c","title":"P05.1: tyr check stdin/stdout scaffolding","description":"Implement `tyr check` to: read JSON from stdin, parse into `PermissionRequest`, and exit with empty output (fall-through). Handle malformed input gracefully (exit 0, empty output if `failOpen`; exit 2 otherwise). Add `--verbose` flag for stderr debug output.\n\nTests: valid JSON -\u003e fall-through, malformed JSON -\u003e exit 2, `--verbose` emits to stderr only.\n\nDepends on: P0.2, P0.3\nBlocks: P05.2, P1.4","status":"closed","priority":1,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T08:11:33.012518-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-14T11:51:30.539641-06:00","closed_at":"2026-02-14T11:51:30.539641-06:00","close_reason":"Closed","dependencies":[{"issue_id":"tyr-33c","depends_on_id":"tyr-42k","type":"blocks","created_at":"2026-02-14T08:11:35.536775-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-33c","depends_on_id":"tyr-36p","type":"blocks","created_at":"2026-02-14T08:11:35.873668-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-36p","title":"P0.3: CLI framework \u0026 subcommand routing","description":"Add subcommand dispatch to `src/cli.ts` using a lightweight arg parser (e.g. `citty`, `cleye`, or hand-rolled). Register stubs for all subcommands: `check`, `install`, `config`, `log`. Unknown subcommands show help.\n\nTests: verify subcommand dispatch routes correctly, unknown subcommands show help.\n\nDepends on: P0.1b\nBlocks: P0.4, P0.5, P05.1, P3.1","status":"closed","priority":1,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T08:11:32.613792-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-14T11:28:37.117843-06:00","closed_at":"2026-02-14T11:28:37.117843-06:00","close_reason":"Closed","dependencies":[{"issue_id":"tyr-36p","depends_on_id":"tyr-8hd","type":"blocks","created_at":"2026-02-14T08:11:34.933263-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-36p","depends_on_id":"tyr-bdv","type":"blocks","created_at":"2026-02-14T08:11:35.103869-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-3qi","title":"Support JSONC for config","description":"Allow comments in ~/.config/tyr/config.json by parsing it as JSONC (JSON with Comments). Use a lightweight approach — either the jsonc-parser npm package or strip // and /* */ comments before parsing. Improves DX by letting users annotate their config.","status":"closed","priority":2,"issue_type":"feature","owner":"noreply@anthropic.com","created_at":"2026-02-16T19:55:15.079738328Z","created_by":"Claude","updated_at":"2026-02-16T20:16:51.087894-06:00","closed_at":"2026-02-16T20:16:51.087894-06:00","close_reason":"Closed"}
{"id":"tyr-42k","title":"P0.2: Define core types","description":"Define TypeScript types/interfaces in `src/types.ts`:\n- `PermissionRequest` (the hook input JSON schema)\n- `PermissionResult` (`\"allow\" | \"deny\" | \"abstain\"`)\n- `Provider` interface (`checkPermission(req: PermissionRequest): Promise\u003cPermissionResult\u003e`)\n- `AgentConfig` interface (reading an agent's permission rules)\n- `TyrConfig` (tyr's own config: `allowChainedCommands`, `allowPromptChecks`, `cacheChecks`, `failOpen`)\n\nTests: type-level tests (compile-time checks), validation tests for PermissionRequest parsing.\n\nDepends on: P0.1b\nBlocks: P0.4, P0.5, P0.6, P05.1, P1.1","status":"closed","priority":1,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T08:11:32.507106-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-14T11:10:49.735316-06:00","closed_at":"2026-02-14T11:10:49.735316-06:00","close_reason":"Closed","dependencies":[{"issue_id":"tyr-42k","depends_on_id":"tyr-bdv","type":"blocks","created_at":"2026-02-14T08:11:35.020176-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-48x","title":"P0.5: tyr install subcommand","description":"Implement `tyr install [--global | --project] [--dry-run]`. Reads/merges the appropriate Claude `settings.json` to add the tyr hook configuration (the `hooks.PermissionRequest` entry from SPEC.md). Must not clobber existing hooks.\n\nTests: merges into empty settings, merges into existing hooks without clobbering, dry-run produces no side effects.\n\nDepends on: P0.2, P0.3\nBlocks: nothing (nice-to-have for onboarding, not on critical path)","status":"closed","priority":2,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T08:11:32.809262-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-14T14:11:33.234314-06:00","closed_at":"2026-02-14T14:11:33.234314-06:00","close_reason":"Closed","dependencies":[{"issue_id":"tyr-48x","depends_on_id":"tyr-42k","type":"blocks","created_at":"2026-02-14T08:11:35.358651-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-48x","depends_on_id":"tyr-36p","type":"blocks","created_at":"2026-02-14T08:11:35.789696-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-4me","title":"Fix hardcoded version string in helpers.test.ts","description":"In src/__tests__/helpers.test.ts:69, the test asserts 'toContain(\"0.1.0\")' which will break on every version bump. Import version from package.json or assert against a version format regex.","status":"closed","priority":3,"issue_type":"bug","owner":"panchal.rushy@gmail.com","created_at":"2026-02-15T21:42:22.555944-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-15T22:15:24.840697-06:00","closed_at":"2026-02-15T22:15:24.840697-06:00","close_reason":"Closed"}
{"id":"tyr-4qp","title":"SQLite E2E tests","description":"End-to-end tests for the full SQLite-backed flow using the subprocess helper from P0.6. Scenarios: (1) First tyr check: cache miss, falls through to providers, result logged with cached=0. (2) Second identical tyr check: cache hit, same result, faster, logged with cached=1. (3) Change Claude config (modify settings file): next check for same command = cache miss (config_hash changed). (4) tyr stats reflects correct counts after the above sequence. (5) tyr suggest recommends frequently approved commands. (6) JSONL migration: create a log.jsonl, run tyr check, verify entries were imported. (7) Corrupt DB handling: verify graceful recovery. Tests use TYR_DB_PATH to isolate test databases.","status":"open","priority":0,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-18T01:15:24.880254-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-18T01:15:24.880254-06:00","dependencies":[{"issue_id":"tyr-4qp","depends_on_id":"tyr-52l","type":"blocks","created_at":"2026-02-18T01:15:35.081104-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-4qp","depends_on_id":"tyr-88a","type":"blocks","created_at":"2026-02-18T01:15:35.174245-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-4qp","depends_on_id":"tyr-1n0","type":"blocks","created_at":"2026-02-18T01:15:35.265572-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-4s5","title":"set up mise with node and bun","description":"Set up mise-en-place (.mise.toml) with pinned Node.js and Bun versions for the project. This ensures all contributors use the same runtime versions. Should create .mise.toml at the repo root with node and bun entries.","status":"closed","priority":0,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T08:13:08.729119-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-14T08:41:01.754111-06:00","closed_at":"2026-02-14T08:41:01.754111-06:00","close_reason":"Closed"}
{"id":"tyr-52l","title":"Config fingerprinting for cache invalidation","description":"Implement config fingerprinting so the cache self-invalidates when Claude settings OR tyr's own config changes. (1) In ClaudeAgent, add a configHash() method that returns a stable hash (SHA-256 hex prefix) of the merged allow/deny rules. (2) Combine with a hash of tyr's decision-affecting config fields (allowChainedCommands, allowPromptChecks, llmProvider, llmModel, llmCanDeny, failOpen). Simplest: hash(sorted_claude_allow + sorted_claude_deny + JSON(tyr_config)). (3) The hash is content-addressed — immune to touch-without-change. (4) CacheProvider uses this hash on every lookup: stored config_hash \\!= current = miss. (5) On miss, DELETE the stale row before pipeline runs (cleanup). (6) Optionally: bulk-invalidate with DELETE FROM cache WHERE config_hash \\!= ?. Tests: same config = same hash, changed Claude config = different hash, changed tyr config = different hash, stale entries are evicted on lookup, bulk invalidation works.","status":"closed","priority":0,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-18T01:15:09.650325-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-18T02:14:14.317242-06:00","closed_at":"2026-02-18T02:14:14.317242-06:00","close_reason":"Already implemented in tyr-5an: computeConfigHash() in cache.ts computes SHA-256 of sorted agent allow/deny + tyr config. config_hash is in the cache PK, so different configs coexist and old entries are naturally superseded.","dependencies":[{"issue_id":"tyr-52l","depends_on_id":"tyr-5an","type":"blocks","created_at":"2026-02-18T01:15:34.779691-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-53y","title":"Database module and schema","description":"Create src/db.ts — the foundation for all SQLite work. Responsibilities: (1) Open/create DB at ~/.local/share/tyr/tyr.db with WAL mode and busy_timeout=5000. (2) Run schema creation (CREATE TABLE IF NOT EXISTS for _meta, logs, cache, llm_logs, plus indexes). (3) Insert schema version into _meta. (4) Export a getDb() function that returns a singleton connection. (5) On getDb(), check schema_version in _meta — if it's behind CURRENT_VERSION, emit an error telling the user to run 'tyr db:migrate'. (6) Respect TYR_DB_PATH env var for testing. Schema is defined in the epic (bd show tyr-6fb). Tests: DB creation in tmp dir, schema tables exist, WAL mode is active, version is set, version mismatch emits actionable error.","status":"closed","priority":0,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-18T01:14:54.58699-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-18T01:49:17.046561-06:00","closed_at":"2026-02-18T01:49:17.046561-06:00","close_reason":"Implemented src/db.ts with SQLite WAL mode, schema creation, version checking, FK enforcement, and TYR_DB_PATH support. 19 tests in db.test.ts.","dependencies":[{"issue_id":"tyr-53y","depends_on_id":"tyr-xdv","type":"blocks","created_at":"2026-02-18T01:17:35.891558-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-5an","title":"Permission decision cache","description":"Add a CacheProvider as the first provider in the pipeline. On checkPermission(): (1) Compute config_hash = hash of merged Claude agent config. (2) Query cache table: SELECT decision, provider, reason FROM cache WHERE tool_name=? AND command=? AND cwd=? AND config_hash=?. (3) Cache hit → return stored decision (set cached=1 in log entry). (4) Cache miss (no row or config_hash mismatch) → return abstain, let pipeline continue. After pipeline produces a definitive result (allow/deny), INSERT OR REPLACE into cache. Wire to cacheChecks config flag — when false, skip cache entirely. Tests: cache hit returns stored decision, cache miss falls through, different commands don't collide, config_hash mismatch = miss, abstain results are not cached.","status":"closed","priority":0,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-18T01:15:04.169477-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-18T02:13:34.67451-06:00","closed_at":"2026-02-18T02:13:34.67451-06:00","close_reason":"Implemented permission decision cache with configHash-based invalidation","dependencies":[{"issue_id":"tyr-5an","depends_on_id":"tyr-53y","type":"blocks","created_at":"2026-02-18T01:15:34.641341-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-5gp","title":"Extract prompts to src/prompts.ts","description":"Move buildPrompt() and related prompt text from src/providers/llm.ts into a dedicated src/prompts.ts module. Re-export for use by the LLM provider. Pure refactor, no behavior change.","status":"closed","priority":3,"issue_type":"feature","owner":"noreply@anthropic.com","created_at":"2026-02-16T19:53:18.887524819Z","created_by":"Claude","updated_at":"2026-02-16T20:18:08.201825-06:00","closed_at":"2026-02-16T20:18:08.201825-06:00","close_reason":"Closed"}
{"id":"tyr-5rz","title":"Implement failOpen config behavior in judge pipeline","description":"TyrConfig.failOpen is defined and configurable but never consulted during the judge pipeline. When agent.init() throws or all providers abstain, behavior should differ based on failOpen. Currently abstain always results in no output (fail-closed) regardless of config setting.","status":"closed","priority":1,"issue_type":"bug","owner":"panchal.rushy@gmail.com","created_at":"2026-02-15T21:44:22.176201-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-15T22:03:41.795101-06:00","closed_at":"2026-02-15T22:03:41.795101-06:00","close_reason":"Closed"}
{"id":"tyr-5t3","title":"setup package.json to publish to @panchr/tyr","description":"setup the package.json to publish the npm package to @panchr/tyr. Make sure only necessary files are included in the package","status":"closed","priority":2,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-15T22:04:44.656568-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-16T20:02:02.384495-06:00","closed_at":"2026-02-16T20:02:02.384495-06:00","close_reason":"Closed"}
{"id":"tyr-5x3","title":"tyr install should default to project","description":"default the tyr install command to project, not to global","status":"closed","priority":0,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-15T19:16:45.147344-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-15T19:48:42.86327-06:00","closed_at":"2026-02-15T19:48:42.86327-06:00","close_reason":"Closed"}
{"id":"tyr-62s","title":"Fix file handle leak in log tail command","description":"In src/commands/log.ts:84-90, if handle.stat() or watch() throws, the file handle opened on line 86/89 is never closed. Use try/finally or a using declaration to ensure cleanup.","status":"closed","priority":3,"issue_type":"bug","owner":"panchal.rushy@gmail.com","created_at":"2026-02-15T21:42:03.498226-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-15T22:10:46.3808-06:00","closed_at":"2026-02-15T22:10:46.3808-06:00","close_reason":"Closed"}
{"id":"tyr-6cu","title":"Support shadow/audit mode in install","description":"Add --shadow and --audit flags to tyr install. When specified, the generated hook JSON includes the corresponding flag (e.g. 'tyr judge --shadow'). Only one of --shadow or --audit can be specified. tyr uninstall needs no changes.","status":"closed","priority":1,"issue_type":"feature","owner":"noreply@anthropic.com","created_at":"2026-02-16T19:54:24.109598687Z","created_by":"Claude","updated_at":"2026-02-16T20:11:54.166066-06:00","closed_at":"2026-02-16T20:11:54.166066-06:00","close_reason":"Closed","dependencies":[{"issue_id":"tyr-6cu","depends_on_id":"tyr-bja","type":"blocks","created_at":"2026-02-16T19:54:24.115947426Z","created_by":"Claude"},{"issue_id":"tyr-6cu","depends_on_id":"tyr-ccs","type":"blocks","created_at":"2026-02-16T19:54:24.120764751Z","created_by":"Claude"}]}
{"id":"tyr-6fb","title":"(EPIC) SQLite Storage Layer","description":"Replace the Phase 3 daemon and Phase 4 persistence with a single SQLite database. Every tyr invocation opens the DB directly (WAL mode + busy_timeout for safe concurrency). Eliminates daemon lifecycle, RPC, socket, PID files. Covers: logging, decision caching, cache invalidation, metrics, and suggestions — all via SQL queries over one DB file at ~/.local/share/tyr/tyr.db. Replaces Phase 3 (tyr-e4o) and Phase 4 (tyr-con) epics.\n\n## Schema (validated by tyr-xdv)\n\n```sql\nPRAGMA journal_mode = WAL;\nPRAGMA busy_timeout = 5000;\n\nCREATE TABLE _meta (\n    key   TEXT PRIMARY KEY,\n    value TEXT NOT NULL\n);\n\nCREATE TABLE logs (\n    id          INTEGER PRIMARY KEY AUTOINCREMENT,\n    timestamp   INTEGER NOT NULL,     -- Unix epoch ms\n    session_id  TEXT    NOT NULL,\n    cwd         TEXT    NOT NULL,\n    tool_name   TEXT    NOT NULL,\n    tool_input  TEXT    NOT NULL,      -- extracted value: Bash command string; non-Bash: JSON.stringify(req.tool_input)\n    input       TEXT    NOT NULL,      -- full JSON blob from PermissionRequest.tool_input\n    decision    TEXT    NOT NULL CHECK (decision IN ('allow','deny','abstain','error')),\n    provider    TEXT,                  -- which provider decided (null = none)\n    reason      TEXT,\n    duration_ms INTEGER NOT NULL,\n    cached      INTEGER NOT NULL DEFAULT 0,\n    mode        TEXT    CHECK (mode IN ('shadow','audit') OR mode IS NULL)\n);\n\nCREATE INDEX idx_logs_timestamp ON logs (timestamp);\nCREATE INDEX idx_logs_session   ON logs (session_id);\nCREATE INDEX idx_logs_suggest   ON logs (decision, mode, tool_input);\n\nCREATE TABLE llm_logs (\n    id       INTEGER PRIMARY KEY AUTOINCREMENT,\n    log_id   INTEGER NOT NULL REFERENCES logs(id),\n    prompt   TEXT    NOT NULL,\n    model    TEXT    NOT NULL\n);\n\nCREATE INDEX idx_llm_logs_log_id ON llm_logs (log_id);\n\nCREATE TABLE cache (\n    tool_name   TEXT    NOT NULL,\n    tool_input  TEXT    NOT NULL,      -- extracted value: Bash command string; non-Bash: JSON.stringify(req.tool_input)\n    cwd         TEXT    NOT NULL,\n    decision    TEXT    NOT NULL CHECK (decision IN ('allow','deny')),\n    provider    TEXT    NOT NULL,\n    reason      TEXT,\n    config_hash TEXT    NOT NULL,      -- stale if current hash differs\n    created_at  INTEGER NOT NULL,      -- Unix epoch ms\n    PRIMARY KEY (tool_name, tool_input, cwd)\n);\n```\n\n## Design Decisions\n- Timestamps are INTEGER (Unix epoch ms) for fast range queries\n- No config_hash on logs — only needed on cache for invalidation\n- config_hash covers BOTH Claude allow/deny rules AND tyr's own config (llmModel, llmCanDeny, llmProvider, allowChainedCommands, allowPromptChecks, failOpen all affect decisions)\n- LLM details in separate llm_logs table (FK to logs.id), only populated with verbose logging\n- tool_input = extracted value (Bash command string, or JSON.stringify(req.tool_input) for non-Bash); input = full JSON blob\n- permission_mode NOT in cache key (no provider uses it, LLM prompt doesn't include it)\n- session_id NOT in cache key (only used for logging)\n- idx_logs_suggest uses (decision, mode, tool_input) to match the tyr suggest query pattern\n- No daemon, no --follow on tyr log","status":"open","priority":0,"issue_type":"epic","owner":"panchal.rushy@gmail.com","created_at":"2026-02-18T01:14:48.158087-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-18T01:34:44.495982-06:00","dependencies":[{"issue_id":"tyr-6fb","depends_on_id":"tyr-53y","type":"blocks","created_at":"2026-02-18T01:15:35.45412-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-6fb","depends_on_id":"tyr-tv7","type":"blocks","created_at":"2026-02-18T01:15:35.553107-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-6fb","depends_on_id":"tyr-5an","type":"blocks","created_at":"2026-02-18T01:15:35.641882-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-6fb","depends_on_id":"tyr-52l","type":"blocks","created_at":"2026-02-18T01:15:35.736098-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-6fb","depends_on_id":"tyr-88a","type":"blocks","created_at":"2026-02-18T01:15:35.89751-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-6fb","depends_on_id":"tyr-1n0","type":"blocks","created_at":"2026-02-18T01:15:36.023995-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-6fb","depends_on_id":"tyr-4qp","type":"blocks","created_at":"2026-02-18T01:15:36.129404-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-6fb","depends_on_id":"tyr-rtf","type":"blocks","created_at":"2026-02-18T01:15:36.233593-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-6fb","depends_on_id":"tyr-xdv","type":"blocks","created_at":"2026-02-18T01:17:35.978005-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-6h9","title":"code quality check","description":"run the reviewer agent for typescript across all files in this project. create an epic and file subtasks under that for all found issues","status":"closed","priority":4,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T15:39:35.650202-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-15T21:43:03.783245-06:00","closed_at":"2026-02-15T21:43:03.783245-06:00","close_reason":"Created epic tyr-0ro with 13 subtask issues covering all code reviewer findings across source files, test files, and test helpers"}
{"id":"tyr-6se","title":"Phase 0: Project Setup \u0026 CLI Foundation","description":"Repo tooling, core types, CLI skeleton with config and install subcommands.","status":"closed","priority":1,"issue_type":"epic","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T08:02:36.414639-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-14T15:22:39.934998-06:00","closed_at":"2026-02-14T15:22:39.934998-06:00","close_reason":"Closed","dependencies":[{"issue_id":"tyr-6se","depends_on_id":"tyr-8hd","type":"blocks","created_at":"2026-02-14T08:12:31.945621-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-6se","depends_on_id":"tyr-bdv","type":"blocks","created_at":"2026-02-14T08:12:32.030691-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-6se","depends_on_id":"tyr-42k","type":"blocks","created_at":"2026-02-14T08:12:32.112843-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-6se","depends_on_id":"tyr-36p","type":"blocks","created_at":"2026-02-14T08:12:32.196113-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-6se","depends_on_id":"tyr-du6","type":"blocks","created_at":"2026-02-14T08:12:32.280413-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-6se","depends_on_id":"tyr-48x","type":"blocks","created_at":"2026-02-14T08:12:32.36441-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-6se","depends_on_id":"tyr-bzs","type":"blocks","created_at":"2026-02-14T08:12:32.448062-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-703","title":"tyr db:migrate subcommand","description":"Implement 'tyr db:migrate' command that runs pending schema migrations. Uses a sequential migration array — each entry is a function that runs SQL to move from version N to N+1. On run: (1) Read schema_version from _meta. (2) Run all migrations from current version to CURRENT_VERSION in order. (3) Update schema_version in _meta. (4) Print what migrations were applied. The cache table is ephemeral and can be DROP+CREATE'd in migrations. The logs and llm_logs tables are historical — migrations should only ADD COLUMN, never drop data. For complex schema changes (changing types/constraints), use the rename-copy-drop pattern. Not needed until the schema actually changes — this is a future task.","status":"open","priority":4,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-18T01:42:03.654707-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-18T01:42:03.654707-06:00"}
{"id":"tyr-75e","title":"add uninstall command","description":"add an uninstall command, similar to install that supports global or per-project and will just uninstall the tyr hook, if it exists. if it doesn't, let the user know but still exit with exit code 0","status":"closed","priority":0,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-15T19:16:26.187962-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-15T19:46:57.170365-06:00","closed_at":"2026-02-15T19:46:57.170365-06:00","close_reason":"Closed"}
{"id":"tyr-7xa","title":"Fix ReDoS potential in matchPattern glob conversion","description":"In src/agents/claude.ts:27-30, matchPattern converts user-provided glob patterns into regexes by replacing * with .*. A pattern like ***** becomes ^.*.*.*.*.*$ causing catastrophic backtracking. Fix by collapsing consecutive * into a single .* or use a glob library.","status":"closed","priority":2,"issue_type":"bug","owner":"panchal.rushy@gmail.com","created_at":"2026-02-15T21:41:57.877543-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-15T22:05:14.687464-06:00","closed_at":"2026-02-15T22:05:14.687464-06:00","close_reason":"Closed"}
{"id":"tyr-88a","title":"tyr stats subcommand","description":"Implement tyr stats [--since \u003cduration\u003e] [--json]. Queries the logs table directly: (1) Total decisions by type (allow/deny/abstain/error). (2) Cache hit rate (SUM(cached)/COUNT(*)). (3) Provider breakdown (decisions grouped by provider). (4) Estimated user-effort saved (count of allow decisions, since each one is an auto-approval the user didn't have to click). (5) --since filters by timestamp (parse duration like '1h', '7d', '30m'). (6) --json outputs raw query results. (7) Default: human-readable formatted table. Tests: stats with no data shows zeros, --since filters correctly, --json is valid JSON, counters match inserted data.","status":"closed","priority":0,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-18T01:15:14.605371-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-18T02:18:37.777642-06:00","closed_at":"2026-02-18T02:18:37.777642-06:00","close_reason":"Implemented tyr stats subcommand with --since and --json flags","dependencies":[{"issue_id":"tyr-88a","depends_on_id":"tyr-tv7","type":"blocks","created_at":"2026-02-18T01:15:34.87748-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-8ee","title":"create a debug command","description":"create a debug subcommand, which itself has another subcommand 'claude-config' that prints out the merged claude config","status":"closed","priority":0,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T15:42:49.657185-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-14T15:50:16.897229-06:00","closed_at":"2026-02-14T15:50:16.897229-06:00","close_reason":"Closed"}
{"id":"tyr-8fc","title":"set model for claude -p","description":"always use the haiku model when invoking claude with claude -p","status":"closed","priority":0,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-15T19:05:31.325484-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-15T19:32:53.283131-06:00","closed_at":"2026-02-15T19:32:53.283131-06:00","close_reason":"Closed"}
{"id":"tyr-8hd","title":"P0.1a: Project bootstrap","description":"Rename package from `claude-fastpass` to `tyr`. Create `src/` directory structure. Create a bare `src/cli.ts` entry point that prints usage/help. Wire up `bin` field in `package.json` so `bun run src/cli.ts` works.\n\nDepends on: nothing\nBlocks: P0.1b, P0.3","status":"closed","priority":1,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T08:11:32.302385-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-14T08:43:01.664532-06:00","closed_at":"2026-02-14T08:43:01.664532-06:00","close_reason":"Closed","dependencies":[{"issue_id":"tyr-8hd","depends_on_id":"tyr-4s5","type":"blocks","created_at":"2026-02-14T08:23:21.590727-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-8ty","title":"DRY up test helper duplication","description":"Multiple duplications in test helpers: (1) writeProjectSettings/writeLocalSettings/writeUserSettings in helpers/settings.ts are near-identical - extract shared writeSettings function. (2) Subprocess result collection duplicated in runJudge and runCli in helpers/subprocess.ts - extract collectResult helper. (3) cli.test.ts has its own local runCli that duplicates the shared helper with a different signature - migrate to shared helper.","status":"closed","priority":3,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-15T21:42:20.082504-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-15T22:14:23.586442-06:00","closed_at":"2026-02-15T22:14:23.586442-06:00","close_reason":"Closed"}
{"id":"tyr-912","title":"add a version subcommand","status":"closed","priority":4,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T14:59:35.016718-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-14T15:53:59.384654-06:00","closed_at":"2026-02-14T15:53:59.384654-06:00","close_reason":"Closed"}
{"id":"tyr-91f","title":"P4.1: Durable on-disk cache","description":"Persist the permission cache to disk (per-project). On daemon start, load from disk. On daemon stop/crash, state survives.\n\nTests: write-then-read round-trip, daemon restart restores cache, corrupt file handled gracefully.\n\nDepends on: P3.2\nBlocks: P4.2, P4.4","status":"closed","priority":3,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T08:11:34.430463-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-18T01:15:41.660769-06:00","closed_at":"2026-02-18T01:15:41.660769-06:00","close_reason":"Replaced by SQLite Storage Layer epic (tyr-6fb). Daemon approach replaced with direct SQLite access.","dependencies":[{"issue_id":"tyr-91f","depends_on_id":"tyr-mm7","type":"blocks","created_at":"2026-02-14T08:11:37.735851-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-9g8","title":"OpenRouter LLM provider","description":"Add OpenRouter as an alternative LLM backend for permission checks, alongside the claude -p subprocess approach (tyr-f81). Users choose via the llmProvider config field ('claude' or 'openrouter', default 'claude'). OpenRouter is OpenAI-compatible, potentially faster (no subprocess spawn), and gives model choice flexibility.","status":"closed","priority":3,"issue_type":"epic","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T21:22:34.550449-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-17T10:56:35.774885-06:00","closed_at":"2026-02-17T10:56:35.774885-06:00","close_reason":"All subtasks complete: provider implemented, wired into judge, unit and E2E tests passing","dependencies":[{"issue_id":"tyr-9g8","depends_on_id":"tyr-oht","type":"blocks","created_at":"2026-02-14T21:22:57.266283-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-9g8","depends_on_id":"tyr-r6g","type":"blocks","created_at":"2026-02-14T21:22:57.351761-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-9q6","title":"make tests concurrent","description":"for whichever tests can easily run concurrently, mark them as concurrent. If you're not sure about a test or if they cannot be concurrent, keep them as-is","status":"closed","priority":4,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T15:29:26.147879-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-14T15:58:12.157042-06:00","closed_at":"2026-02-14T15:58:12.157042-06:00","close_reason":"Closed"}
{"id":"tyr-ac6","title":"Add timeouts to subprocess-based tests","description":"Many tests spawn 'bun run src/index.ts' subprocesses but have no timeout. If a subprocess hangs, the test hangs indefinitely. Add timeout: 10_000 to subprocess-based test blocks, similar to smoke tests.","status":"closed","priority":3,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-15T21:42:25.135085-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-15T22:21:09.057816-06:00","closed_at":"2026-02-15T22:21:09.057816-06:00","close_reason":"Closed"}
{"id":"tyr-aid","title":"timestamp timezones","description":"always store timestamps in the DB in UTC, but display the timestamp in the local timezone in tyr log","status":"open","priority":1,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-18T08:55:27.2124-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-18T08:55:27.2124-06:00"}
{"id":"tyr-au6","title":"P2.3: Phase 2 E2E tests","description":"End-to-end tests for the full Phase 2 flow using the subprocess helper from P0.6: verify that when chained-commands abstains, the LLM provider is consulted. Cover: LLM approves, LLM denies, LLM times out (fall-through), denied command never reaches LLM.\n\nDepends on: P0.6, P2.1\nBlocks: nothing","status":"closed","priority":2,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T08:11:34.033288-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-15T18:51:03.725299-06:00","closed_at":"2026-02-15T18:51:03.725299-06:00","close_reason":"8 E2E tests covering LLM allow/deny, error fallthrough, invalid JSON, permission short-circuiting, config toggle, and code fence parsing","dependencies":[{"issue_id":"tyr-au6","depends_on_id":"tyr-bzs","type":"blocks","created_at":"2026-02-14T08:11:36.47994-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-au6","depends_on_id":"tyr-f81","type":"blocks","created_at":"2026-02-14T08:11:37.437324-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-bda","title":"Reduce unsafe type assertions in install.test.ts","description":"In src/__tests__/install.test.ts, chains of 'as Record\u003cstring, unknown\u003e' / 'as unknown[]' type assertions appear at lines 77-78, 91-92, 109-110, 263-264, 296-297, 403-404. Define a type for the expected settings shape or use Zod parsing for runtime validation. Also address forced type assertion on overrides in judge-e2e.test.ts and llm-provider.test.ts.","status":"closed","priority":4,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-15T21:42:29.011767-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-15T22:26:06.432864-06:00","closed_at":"2026-02-15T22:26:06.432864-06:00","close_reason":"Closed"}
{"id":"tyr-bdv","title":"P0.1b: Tooling setup","description":"Set up linting (biome or eslint), formatting, and typechecking scripts in `package.json`. Add a `bun test` configuration. Ensure `bun run lint`, `bun run typecheck`, and `bun test` all work (even if there are no tests yet).\n\nDepends on: P0.1a\nBlocks: P0.2, P0.3, P1.2","status":"closed","priority":1,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T08:11:32.401063-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-14T08:48:59.24618-06:00","closed_at":"2026-02-14T08:48:59.24618-06:00","close_reason":"Closed","dependencies":[{"issue_id":"tyr-bdv","depends_on_id":"tyr-8hd","type":"blocks","created_at":"2026-02-14T08:11:34.844208-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-be9","title":"Add verbose logging mode","description":"Add --verbose-log flag to tyr judge (and verboseLog config key). When enabled, the LogEntry includes additional fields: the full LLM prompt text sent, and the LLM parameters used (model, timeout, endpoint). Useful for debugging LLM decisions after the fact.","status":"closed","priority":3,"issue_type":"feature","owner":"noreply@anthropic.com","created_at":"2026-02-16T19:55:31.786533909Z","created_by":"Claude","updated_at":"2026-02-16T20:30:16.689583-06:00","closed_at":"2026-02-16T20:30:16.689583-06:00","close_reason":"Closed","dependencies":[{"issue_id":"tyr-be9","depends_on_id":"tyr-5gp","type":"blocks","created_at":"2026-02-16T19:55:31.7921374Z","created_by":"Claude"}]}
{"id":"tyr-bec","title":"allow viewing verbose logs (LLM logs) with tyr log)","description":"add a flag to tyr log that lets me view verbose logs","status":"open","priority":1,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-18T09:48:07.387332-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-18T09:48:07.387332-06:00"}
{"id":"tyr-bh3","title":"P05.3: tyr log subcommand","description":"Implement `tyr log [--last \u003cn\u003e] [--json] [--follow]`. Reads the log file and formats output. `--follow` tails the file.\n\nTests: `--last` limits output, `--json` outputs valid JSON, empty log file handled gracefully.\n\nDepends on: P05.2\nBlocks: nothing","status":"closed","priority":2,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T08:11:33.212962-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-14T12:39:34.687869-06:00","closed_at":"2026-02-14T12:39:34.687869-06:00","close_reason":"Closed","dependencies":[{"issue_id":"tyr-bh3","depends_on_id":"tyr-g33","type":"blocks","created_at":"2026-02-14T08:11:36.213099-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-bh3","depends_on_id":"tyr-36p","type":"blocks","created_at":"2026-02-14T08:23:16.67198-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-bio","title":"Add zod validation for PermissionRequest parsing","description":"Replace hand-rolled parsePermissionRequest checks with zod schema validation. Define a PermissionRequest schema that validates all fields (session_id, transcript_path, cwd, permission_mode, hook_event_name, tool_name, tool_input). Update src/check.ts and ensure existing tests still pass. Add tests for edge cases (extra fields should be allowed, missing required fields should fail).","status":"closed","priority":0,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T11:57:55.327834-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-14T11:58:56.662425-06:00","closed_at":"2026-02-14T11:58:56.662425-06:00","close_reason":"Closed"}
{"id":"tyr-bja","title":"Add shadow mode to judge","description":"Add --shadow CLI flag to tyr judge. When enabled, runs the full decision pipeline (providers, LLM, etc.) but always outputs empty (abstain) to Claude Code regardless of the actual decision. The real decision is still logged. This lets users evaluate tyr's behavior without it affecting anything.","status":"closed","priority":1,"issue_type":"feature","owner":"noreply@anthropic.com","created_at":"2026-02-16T19:53:41.396091318Z","created_by":"Claude","updated_at":"2026-02-16T19:57:12.761724-06:00","closed_at":"2026-02-16T19:57:12.761724-06:00","close_reason":"Closed"}
{"id":"tyr-bzs","title":"P0.6: Test infrastructure","description":"Create shared test fixtures and helpers:\n- Sample `PermissionRequest` JSON payloads (valid, malformed, edge cases) as typed factory functions.\n- Mock Claude settings files (global, project, local) for agent config tests.\n- A test helper that spawns `tyr check` as a subprocess, pipes stdin, and asserts on stdout/stderr/exit code. Used by E2E tests (P1.5, P2.3).\n\nTests: verify the subprocess helper captures stdout, stderr, and exit code correctly.\n\nDepends on: P0.2\nBlocks: P1.5, P2.3","status":"closed","priority":2,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T08:11:32.912542-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-14T15:22:14.34576-06:00","closed_at":"2026-02-14T15:22:14.34576-06:00","close_reason":"Closed","dependencies":[{"issue_id":"tyr-bzs","depends_on_id":"tyr-42k","type":"blocks","created_at":"2026-02-14T08:11:35.442476-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-cb2","title":"Validate TyrConfig with Zod instead of unsafe spread","description":"In src/config.ts:28-29, parsed config is spread over defaults without validation. Unexpected keys (typos, old keys) are silently included. Validate with Zod like PermissionRequest and LogEntry for consistency and helpful error messages.","status":"closed","priority":3,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-15T21:42:09.34745-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-15T22:13:02.522694-06:00","closed_at":"2026-02-15T22:13:02.522694-06:00","close_reason":"Closed"}
{"id":"tyr-ccs","title":"Add audit mode to judge","description":"Add --audit CLI flag to tyr judge. When enabled, skips the decision pipeline entirely — just logs the raw permission request (tool, command, cwd, session) and outputs empty. Pure observability with zero risk. No providers are invoked.","status":"closed","priority":1,"issue_type":"feature","owner":"noreply@anthropic.com","created_at":"2026-02-16T19:53:59.450507216Z","created_by":"Claude","updated_at":"2026-02-16T20:00:02.152087-06:00","closed_at":"2026-02-16T20:00:02.152087-06:00","close_reason":"Closed"}
{"id":"tyr-con","title":"Phase 4: Persistence \u0026 Metrics","description":"Durable cache, decision metrics, and permission suggestions.","status":"closed","priority":3,"issue_type":"epic","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T08:11:32.20327-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-18T01:15:41.781201-06:00","closed_at":"2026-02-18T01:15:41.781201-06:00","close_reason":"Replaced by SQLite Storage Layer epic (tyr-6fb). Daemon approach replaced with direct SQLite access.","dependencies":[{"issue_id":"tyr-con","depends_on_id":"tyr-91f","type":"blocks","created_at":"2026-02-14T08:12:33.732186-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-con","depends_on_id":"tyr-1zm","type":"blocks","created_at":"2026-02-14T08:12:33.815039-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-con","depends_on_id":"tyr-j3v","type":"blocks","created_at":"2026-02-14T08:12:33.897551-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-con","depends_on_id":"tyr-hw1","type":"blocks","created_at":"2026-02-14T08:12:33.982632-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-con","depends_on_id":"tyr-w1b","type":"blocks","created_at":"2026-02-14T08:27:58.853877-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-cv8","title":"Wire LLM config values (llmModel, llmTimeout, etc.) into LlmProvider","description":"LlmProvider hardcodes 'haiku' as the model and ignores llmModel, llmProvider, llmTimeout, and llmEndpoint from TyrConfig. The config values are dead code. In judge.ts:77, the provider is constructed without passing config. LlmProvider should accept TyrConfig and use those values.","status":"closed","priority":1,"issue_type":"bug","owner":"panchal.rushy@gmail.com","created_at":"2026-02-15T21:44:18.569123-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-15T22:01:53.947998-06:00","closed_at":"2026-02-15T22:01:53.947998-06:00","close_reason":"Closed"}
{"id":"tyr-dbx","title":"Add type declarations for mvdan-sh","description":"In src/providers/shell-parser.ts:1-2, mvdan-sh is required via CJS require and typed as any. The entire syntax object and all its methods are untyped, meaning typos or API changes are runtime errors. Create a minimal .d.ts file for the methods used (NodeType, NewParser, Walk, etc.).","status":"closed","priority":3,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-15T21:42:06.693297-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-15T22:12:04.124163-06:00","closed_at":"2026-02-15T22:12:04.124163-06:00","close_reason":"Closed"}
{"id":"tyr-dfe","title":"fix all bun lint issues","status":"closed","priority":1,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-15T23:00:39.834376-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-16T19:53:48.929734-06:00","closed_at":"2026-02-16T19:53:48.929734-06:00","close_reason":"Closed"}
{"id":"tyr-dhj","title":"Add zod schema for LogEntry","description":"LogEntry in src/log.ts is a plain TypeScript interface with no runtime validation. Log entries are read back with a raw JSON.parse cast. Add a zod schema (like PermissionRequestSchema) so malformed or legacy entries are validated at read time instead of crashing at format time.","status":"closed","priority":4,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T14:40:44.33254-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-14T15:55:10.315324-06:00","closed_at":"2026-02-14T15:55:10.315324-06:00","close_reason":"Closed"}
{"id":"tyr-dnv","title":"rename check","description":"rename tyr check to tyr judge","status":"closed","priority":0,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T15:42:58.979532-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-14T15:52:47.100293-06:00","closed_at":"2026-02-14T15:52:47.100293-06:00","close_reason":"Closed"}
{"id":"tyr-du6","title":"P0.4: tyr config subcommand","description":"Implement `src/config.ts` for reading/writing tyr's own config file (`~/.config/tyr/config.json` or similar). Implement `tyr config show`, `tyr config set \u003ckey\u003e \u003cvalue\u003e`, `tyr config path`. Include defaults and validation.\n\nTests: read/write round-trip, default values, invalid key rejection, missing file creation.\n\nDepends on: P0.2, P0.3\nBlocks: nothing (not on critical path)","status":"closed","priority":2,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T08:11:32.715567-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-14T15:13:43.719824-06:00","closed_at":"2026-02-14T15:13:43.719824-06:00","close_reason":"Closed","dependencies":[{"issue_id":"tyr-du6","depends_on_id":"tyr-42k","type":"blocks","created_at":"2026-02-14T08:11:35.272995-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-du6","depends_on_id":"tyr-36p","type":"blocks","created_at":"2026-02-14T08:11:35.704456-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-dvf","title":"Clean up unsafe double cast in LLM response parsing","description":"In src/providers/llm.ts:69, 'as unknown as LlmDecision' double cast is used after guard validation. A single assertion would suffice. Also fix the non-null assertion style in src/args.ts:26.","status":"closed","priority":4,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-15T21:42:15.982107-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-15T22:22:35.398275-06:00","closed_at":"2026-02-15T22:22:35.398275-06:00","close_reason":"Closed"}
{"id":"tyr-dy7","title":"Override all config values via CLI args","description":"Every key in TyrConfig (allowChainedCommands, allowPromptChecks, cacheChecks, failOpen, llmProvider, llmModel, llmEndpoint, llmTimeout, llmCanDeny) should be passable as a CLI arg to tyr judge, overriding the config file value. Use kebab-case flags (e.g. --llm-provider, --fail-open). Enables project-specific hooks with different configs without separate config files.","status":"closed","priority":2,"issue_type":"feature","owner":"noreply@anthropic.com","created_at":"2026-02-16T19:54:41.078243845Z","created_by":"Claude","updated_at":"2026-02-16T20:06:32.274541-06:00","closed_at":"2026-02-16T20:06:32.274541-06:00","close_reason":"Closed"}
{"id":"tyr-e4o","title":"Phase 3: Caching Daemon","description":"Background daemon that caches permission decisions to avoid repeated provider invocations.","status":"closed","priority":3,"issue_type":"epic","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T08:11:32.102969-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-18T01:15:41.640033-06:00","closed_at":"2026-02-18T01:15:41.640033-06:00","close_reason":"Replaced by SQLite Storage Layer epic (tyr-6fb). Daemon approach replaced with direct SQLite access.","dependencies":[{"issue_id":"tyr-e4o","depends_on_id":"tyr-rzx","type":"blocks","created_at":"2026-02-14T08:12:33.468898-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-e4o","depends_on_id":"tyr-mm7","type":"blocks","created_at":"2026-02-14T08:12:33.56152-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-e4o","depends_on_id":"tyr-ox4","type":"blocks","created_at":"2026-02-14T08:12:33.647492-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-e4o","depends_on_id":"tyr-2kd","type":"blocks","created_at":"2026-02-14T08:27:58.084488-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-e7g","title":"add  --no-session-persistence to claude -p command","status":"closed","priority":0,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-15T20:53:50.539522-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-15T22:50:28.729681-06:00","closed_at":"2026-02-15T22:50:28.729681-06:00","close_reason":"Closed"}
{"id":"tyr-ei2","title":"tyr version fails","description":"tyr version fails with no such directory package.json","status":"closed","priority":2,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T15:59:46.791139-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-15T18:44:46.243949-06:00","closed_at":"2026-02-15T18:44:46.243949-06:00","close_reason":"Fixed version command to not crash in compiled binaries; added shared VERSION constant with build-time injection"}
{"id":"tyr-ewl","title":"Implement OpenRouter LLM provider","description":"Create src/providers/llm.ts implementing the Provider interface. Use fetch to call OpenRouter's chat completions endpoint. Construct a structured prompt with the permission context (command, tool, existing allow/deny rules). Parse the JSON response into allow/deny/abstain. Read API key from OPENROUTER_API_KEY env var. Abstain if allowPromptChecks is false or API key is missing. Use Bun.fetch with AbortSignal for timeout handling.","status":"closed","priority":3,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T21:22:43.361732-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-17T10:49:48.125429-06:00","closed_at":"2026-02-17T10:49:48.125429-06:00","close_reason":"Closed","dependencies":[{"issue_id":"tyr-ewl","depends_on_id":"tyr-mdg","type":"blocks","created_at":"2026-02-14T21:22:56.779172-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-ewl","depends_on_id":"tyr-1pr","type":"blocks","created_at":"2026-02-14T21:22:56.893198-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-f81","title":"P2.1: LLM provider implementation","description":"Implement `src/providers/llm.ts` satisfying the `Provider` interface. Invoke `claude -p` as a subprocess with a structured prompt templated with the permission set from the agent config. Parse the JSON response. Only enabled when `allowPromptChecks` is true in tyr config.\n\n**Security constraint (injection protection):** Use `Bun.spawn` with array args (no shell interpolation). Never pass user-controlled strings through a shell. This is a design requirement, not a follow-up.\n\n**Note on hallucination guard:** Explicit deny checking in P1.4's pipeline already prevents any provider (including this one) from overriding deny rules. No additional guard logic is needed here — the architecture enforces it.\n\nTests: mock subprocess to verify correct args/prompt, response parsing (valid JSON, invalid JSON, timeout), `allowPromptChecks: false` -\u003e provider abstains, verify `Bun.spawn` is called with array args (not shell string).\n\nDepends on: P1.4, P1.1\nBlocks: P2.2, P2.3","status":"closed","priority":2,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T08:11:33.833955-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-15T18:47:54.57645-06:00","closed_at":"2026-02-15T18:47:54.57645-06:00","close_reason":"Implemented LlmProvider using claude -p subprocess with structured prompts, JSON response parsing, timeout handling, and injection-safe Bun.spawn array args","dependencies":[{"issue_id":"tyr-f81","depends_on_id":"tyr-t9c","type":"blocks","created_at":"2026-02-14T08:11:36.752001-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-f81","depends_on_id":"tyr-0ql","type":"blocks","created_at":"2026-02-14T08:11:37.183083-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-f81","depends_on_id":"tyr-du6","type":"blocks","created_at":"2026-02-14T08:23:18.370906-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-fb0","title":"treat the cache as a provider itself","description":"treat the cache as a provider, so its decisions appear in the logs too. the cache is a special provider in that pieces of it can be invalidated, but essentially it'd be the first layer before any other provider","status":"open","priority":0,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-18T09:47:25.83858-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-18T09:47:25.83858-06:00"}
{"id":"tyr-fkv","title":"populate the readme","description":"populate the readme with how to run and install the tool, and what it does. also add a warning that this is an experimental tool and without a stable API or configuration schema","status":"closed","priority":0,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-15T22:00:43.270134-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-15T22:51:17.679461-06:00","closed_at":"2026-02-15T22:51:17.679461-06:00","close_reason":"Closed"}
{"id":"tyr-fte","title":"Add log filtering","description":"Add filter flags to tyr log: --since and --until (ISO timestamp or relative like '1h', '30m'), --decision (allow|deny|abstain|error), --provider (provider name), and --cwd (path prefix match). Filters are applied before the --last limit. Multiple filters are ANDed together.","status":"closed","priority":2,"issue_type":"feature","owner":"noreply@anthropic.com","created_at":"2026-02-16T19:54:58.121518832Z","created_by":"Claude","updated_at":"2026-02-16T20:15:23.532139-06:00","closed_at":"2026-02-16T20:15:23.532139-06:00","close_reason":"Closed"}
{"id":"tyr-g1o","title":"P2.2: LLM provider adversarial test suite","description":"Comprehensive adversarial test suite for the LLM provider's input handling. Test with: shell metacharacters (`; rm -rf /`, backticks, `$()`), newlines, null bytes, extremely long commands, unicode edge cases, quote escaping attempts. Verify none of these result in shell injection.\n\nDepends on: P2.1\nBlocks: nothing (but must pass before any real usage)","status":"closed","priority":2,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T08:11:33.934139-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-15T18:49:20.63085-06:00","closed_at":"2026-02-15T18:49:20.63085-06:00","close_reason":"28 adversarial tests covering shell metacharacters, injection attempts, unicode, null bytes, long inputs, and malformed LLM responses","dependencies":[{"issue_id":"tyr-g1o","depends_on_id":"tyr-f81","type":"blocks","created_at":"2026-02-14T08:11:37.352787-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-g33","title":"P05.2: Permission check logging","description":"Create a structured log writer (`src/log.ts`) that appends permission check entries (timestamp, tool, command, decision, provider, duration) to a log file (`~/.local/share/tyr/log.jsonl` or similar). Integrate into `tyr check` so every invocation is logged.\n\nTests: log entry schema validation, file creation on first write, append semantics, log rotation (if applicable).\n\nDepends on: P05.1\nBlocks: P05.3, P1.4","status":"closed","priority":1,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T08:11:33.111117-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-14T11:54:45.674683-06:00","closed_at":"2026-02-14T11:54:45.674683-06:00","close_reason":"Closed","dependencies":[{"issue_id":"tyr-g33","depends_on_id":"tyr-33c","type":"blocks","created_at":"2026-02-14T08:11:36.046337-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-hw1","title":"P4.4: tyr suggest subcommand","description":"Implement `tyr suggest [--apply] [--global | --project]`. Analyze decision history to find commands that are frequently auto-approved. Suggest adding them as permanent allow rules in Claude's settings. `--apply` writes them directly.\n\nTests: suggestions based on frequency threshold, `--apply` merges into settings without clobbering, dry-run (default) produces no side effects.\n\nDepends on: P4.1, P1.1 (needs agent config reader/writer)\nBlocks: nothing","status":"closed","priority":3,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T08:11:34.752368-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-18T01:15:41.726536-06:00","closed_at":"2026-02-18T01:15:41.726536-06:00","close_reason":"Replaced by SQLite Storage Layer epic (tyr-6fb). Daemon approach replaced with direct SQLite access.","dependencies":[{"issue_id":"tyr-hw1","depends_on_id":"tyr-91f","type":"blocks","created_at":"2026-02-14T08:11:37.908727-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-hw1","depends_on_id":"tyr-t9c","type":"blocks","created_at":"2026-02-14T08:23:16.022939-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-ivn","title":"configurable denials in the llm provider","description":"the LLM provider should have a config setting that specifies whether it can deny or not. The default setting, false, means that claude -p would never deny a command. Either it approves it or it abstains from a decision (so that the user is prompted). If set to true, claude -p can either deny, approve, or abstain. This should essentially just change the prompt given to claude -p","status":"closed","priority":0,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-15T22:49:03.198816-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-15T22:54:21.505524-06:00","closed_at":"2026-02-15T22:54:21.505524-06:00","close_reason":"Closed"}
{"id":"tyr-j3v","title":"P4.3: tyr stats subcommand","description":"Implement `tyr stats [--since \u003cduration\u003e] [--json]`. Read metrics from disk and display formatted output.\n\nTests: `--since` filters correctly, `--json` outputs valid JSON, no metrics -\u003e friendly empty state.\n\nDepends on: P4.2\nBlocks: nothing","status":"closed","priority":3,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T08:11:34.647695-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-18T01:15:41.705051-06:00","closed_at":"2026-02-18T01:15:41.705051-06:00","close_reason":"Replaced by SQLite Storage Layer epic (tyr-6fb). Daemon approach replaced with direct SQLite access.","dependencies":[{"issue_id":"tyr-j3v","depends_on_id":"tyr-1zm","type":"blocks","created_at":"2026-02-14T08:11:37.993423-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-l2l","title":"Extract shared env save/restore test helper","description":"Env variable save/restore pattern is duplicated across config.test.ts, claude-agent.test.ts, and log.test.ts. Create a shared helper like withEnv(varName, value, fn) or saveRestoreEnv(varName) to reduce duplication.","status":"closed","priority":4,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-15T21:42:31.3739-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-15T22:27:56.173707-06:00","closed_at":"2026-02-15T22:27:56.173707-06:00","close_reason":"Closed"}
{"id":"tyr-mdg","title":"Extend TyrConfig with LLM settings","description":"Add new fields to TyrConfig in src/types.ts: llmProvider ('claude' | 'openrouter', default 'claude'), llmModel (string, default 'anthropic/claude-3.5-haiku'), llmEndpoint (string, default 'https://openrouter.ai/api/v1'), llmTimeout (number, default 10). llmModel/llmEndpoint only apply when llmProvider is 'openrouter'. Update DEFAULT_TYR_CONFIG with defaults. Update isValidKey and parseValue in src/config.ts to handle the new string/number fields.","status":"closed","priority":3,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T21:22:40.06833-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-15T19:50:44.299736-06:00","closed_at":"2026-02-15T19:50:44.299736-06:00","close_reason":"Closed"}
{"id":"tyr-mft","title":"tyr install should be idempotent","description":"if the tyr hook already exists, just overwrite it","status":"closed","priority":2,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T16:00:48.895178-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-14T17:32:59.073817-06:00","closed_at":"2026-02-14T17:32:59.073817-06:00","close_reason":"Closed"}
{"id":"tyr-mm7","title":"P3.2: In-memory permission cache","description":"Add a cache layer to the daemon that stores permission decisions keyed by (command, cwd, permission_mode). `tyr check` queries the daemon first before running providers. Cache hits skip provider execution entirely. Integrate as the first provider in the pipeline runner from P1.4.\n\nTests: cache hit returns stored decision, cache miss falls through to next provider, different keys don't collide.\n\nDepends on: P3.1, P1.4\nBlocks: P3.3, P4.1","status":"closed","priority":3,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T08:11:34.233541-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-18T01:15:41.580878-06:00","closed_at":"2026-02-18T01:15:41.580878-06:00","close_reason":"Replaced by SQLite Storage Layer epic (tyr-6fb). Daemon approach replaced with direct SQLite access.","dependencies":[{"issue_id":"tyr-mm7","depends_on_id":"tyr-0ql","type":"blocks","created_at":"2026-02-14T08:11:37.267244-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-mm7","depends_on_id":"tyr-rzx","type":"blocks","created_at":"2026-02-14T08:11:37.543962-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-np8","title":"Add try/catch around JSON.parse in log entry reading","description":"In src/log.ts:41, JSON.parse is called on each log line without try/catch. If a log line contains invalid JSON (truncated write, disk corruption), it throws and aborts the entire readLogEntries call. The Zod safeParse won't help because the error happens before it. Wrap in try/catch to skip malformed lines, consistent with how tailLog in log.ts already handles this.","status":"closed","priority":2,"issue_type":"bug","owner":"panchal.rushy@gmail.com","created_at":"2026-02-15T21:42:01.462758-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-15T22:06:22.172985-06:00","closed_at":"2026-02-15T22:06:22.172985-06:00","close_reason":"Closed"}
{"id":"tyr-nr9","title":"Phase 1: Chained Commands Provider","description":"Read Claude's permission config, parse shell commands, and auto-approve chained commands where each sub-command is individually allowed.","status":"closed","priority":1,"issue_type":"epic","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T08:11:31.900092-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-14T15:24:03.430345-06:00","closed_at":"2026-02-14T15:24:03.430345-06:00","close_reason":"Closed","dependencies":[{"issue_id":"tyr-nr9","depends_on_id":"tyr-t9c","type":"blocks","created_at":"2026-02-14T08:12:32.795953-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-nr9","depends_on_id":"tyr-wfg","type":"blocks","created_at":"2026-02-14T08:12:32.879522-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-nr9","depends_on_id":"tyr-10l","type":"blocks","created_at":"2026-02-14T08:12:32.964455-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-nr9","depends_on_id":"tyr-0ql","type":"blocks","created_at":"2026-02-14T08:12:33.051984-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-nr9","depends_on_id":"tyr-2zp","type":"blocks","created_at":"2026-02-14T08:12:33.134564-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-oht","title":"LLM provider E2E tests","description":"Create src/__tests__/llm-e2e.test.ts. Test the full pipeline with the LLM provider enabled via config, using a mock HTTP server (Bun.serve) to simulate OpenRouter responses. Verify allow/deny decisions flow through to HookResponse stdout.","status":"closed","priority":3,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T21:22:49.818634-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-17T10:56:17.585052-06:00","closed_at":"2026-02-17T10:56:17.585052-06:00","close_reason":"Closed","dependencies":[{"issue_id":"tyr-oht","depends_on_id":"tyr-27j","type":"blocks","created_at":"2026-02-14T21:22:57.183703-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-ox4","title":"P3.3: Cache invalidation on config changes","description":"Integrate the agent config file watcher from P1.1 into the daemon. When Claude's settings change, re-evaluate cached chain-based decisions and evict invalid entries. Prompt-based entries are evicted unconditionally (too expensive to re-evaluate).\n\nTests: config change evicts affected entries, unaffected entries survive, prompt-based entries always evicted on change.\n\nDepends on: P3.2, P1.1\nBlocks: nothing","status":"closed","priority":3,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T08:11:34.333784-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-18T01:15:41.601085-06:00","closed_at":"2026-02-18T01:15:41.601085-06:00","close_reason":"Replaced by SQLite Storage Layer epic (tyr-6fb). Daemon approach replaced with direct SQLite access.","dependencies":[{"issue_id":"tyr-ox4","depends_on_id":"tyr-t9c","type":"blocks","created_at":"2026-02-14T08:11:36.839205-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-ox4","depends_on_id":"tyr-mm7","type":"blocks","created_at":"2026-02-14T08:11:37.629548-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-pav","title":"README: safer alternative to dangerouslySkipPermissions","description":"Add a section to the README positioning tyr as a safer, auditable alternative to Claude Code's --dangerously-skip-permissions flag. Explain the adoption spectrum: audit mode (pure logging) → shadow mode (evaluate but don't act) → active mode (full automation). Highlight how tyr provides granular, pattern-based control with an audit trail.","status":"closed","priority":3,"issue_type":"feature","owner":"noreply@anthropic.com","created_at":"2026-02-16T19:55:48.828495754Z","created_by":"Claude","updated_at":"2026-02-16T20:33:43.28448-06:00","closed_at":"2026-02-16T20:33:43.28448-06:00","close_reason":"Closed","dependencies":[{"issue_id":"tyr-pav","depends_on_id":"tyr-bja","type":"blocks","created_at":"2026-02-16T19:55:48.835925398Z","created_by":"Claude"},{"issue_id":"tyr-pav","depends_on_id":"tyr-ccs","type":"blocks","created_at":"2026-02-16T19:55:48.841144691Z","created_by":"Claude"}]}
{"id":"tyr-pdh","title":"Fix ClaudeAgent resource leaks and race conditions in concurrent tests","description":"Multiple test files create ClaudeAgent instances in concurrent describe blocks without proper init/close lifecycle: (1) llm-adversarial.test.ts:13 shares one uninitialized agent across all concurrent tests with no close(). (2) llm-provider.test.ts:7-8 creates agents per test but never closes them. (3) llm-provider.test.ts:117-151 uses spyOn(Bun, 'spawn') inside describe.concurrent, mutating a global while other concurrent tests may spawn processes. Fix: add afterEach/afterAll cleanup, move spyOn test out of concurrent block.","status":"closed","priority":2,"issue_type":"bug","owner":"panchal.rushy@gmail.com","created_at":"2026-02-15T21:44:52.115395-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-15T22:10:05.585506-06:00","closed_at":"2026-02-15T22:10:05.585506-06:00","close_reason":"Closed"}
{"id":"tyr-r6g","title":"LLM provider unit tests","description":"Create src/__tests__/llm-provider.test.ts. Mock global fetch to verify: correct endpoint/headers/body construction, response parsing (valid JSON, invalid JSON, non-200 status), timeout handling, abstain when allowPromptChecks is false, abstain when OPENROUTER_API_KEY is missing, temperature is 0 for deterministic classification.","status":"closed","priority":3,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T21:22:47.912846-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-17T10:53:00.272632-06:00","closed_at":"2026-02-17T10:53:00.272632-06:00","close_reason":"Closed","dependencies":[{"issue_id":"tyr-r6g","depends_on_id":"tyr-ewl","type":"blocks","created_at":"2026-02-14T21:22:57.09402-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-rtf","title":"Update docs: remove daemon, add SQLite","description":"Update documentation to reflect the SQLite approach: (1) SPEC.md: remove tyr daemon subcommand section, remove --follow from tyr log, update decision flow to show cache as a SQLite lookup (not daemon query), update subcommand roadmap table. (2) PLAN.md: update Phase 3 description to say SQLite instead of daemon, merge Phase 4 into Phase 3 (persistence is now free), update caching section. (3) README.md: change log.jsonl reference to SQLite (line 30), remove --tail from tyr log usage (line 73). (4) Remove any references to daemon start/stop/status, IPC, sockets.","status":"open","priority":0,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-18T01:15:29.369691-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-18T01:18:51.600547-06:00","dependencies":[{"issue_id":"tyr-rtf","depends_on_id":"tyr-4qp","type":"blocks","created_at":"2026-02-18T01:15:35.355698-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-rzx","title":"P3.1: tyr daemon subcommand","description":"Implement `tyr daemon start [--port \u003cport\u003e]`, `tyr daemon stop`, `tyr daemon status`. Start a lightweight HTTP/IPC server that `tyr check` can query.\n\nTests: start/stop lifecycle, status reports correctly, port conflict handling.\n\nDepends on: P0.3\nBlocks: P3.2","status":"closed","priority":3,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T08:11:34.13412-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-18T01:15:41.559147-06:00","closed_at":"2026-02-18T01:15:41.559147-06:00","close_reason":"Replaced by SQLite Storage Layer epic (tyr-6fb). Daemon approach replaced with direct SQLite access.","dependencies":[{"issue_id":"tyr-rzx","depends_on_id":"tyr-36p","type":"blocks","created_at":"2026-02-14T08:11:35.958437-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-ssx","title":"Fix timer leak in LlmProvider timeout handling","description":"In src/providers/llm.ts, the setTimeout timer is never cleared after Promise.race resolves. This keeps the event loop alive unnecessarily. Fix by calling clearTimeout after the race. Also address the unbounded stdin read in judge.ts (no size limit on readStdin).","status":"closed","priority":2,"issue_type":"bug","owner":"panchal.rushy@gmail.com","created_at":"2026-02-15T21:41:55.093958-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-15T22:04:26.182725-06:00","closed_at":"2026-02-15T22:04:26.182725-06:00","close_reason":"Closed"}
{"id":"tyr-t9c","title":"P1.1: Claude agent config reader","description":"Implement `src/agents/claude.ts` satisfying the `AgentConfig` interface. Read and merge Claude's settings from all precedence levels (global `~/.claude/settings.json`, project `.claude/settings.json`, and `.claude/settings.local.json`). Extract the set of allowed and denied command patterns. Expose a method like `isCommandAllowed(cmd: string): \"allow\" | \"deny\" | \"unknown\"`.\n\nAlso implement a file watcher that detects changes to any of the settings files and re-reads the merged config. This watcher is used by P3.3 (cache invalidation) and should emit change events.\n\nTests: precedence merging (project overrides global), pattern matching (glob, prefix), deny takes priority over allow, watcher detects file changes.\n\nDepends on: P0.2\nBlocks: P1.3, P1.4, P2.1, P3.3","status":"closed","priority":1,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T08:11:33.314635-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-14T15:00:14.790381-06:00","closed_at":"2026-02-14T15:00:14.790381-06:00","close_reason":"Closed","dependencies":[{"issue_id":"tyr-t9c","depends_on_id":"tyr-42k","type":"blocks","created_at":"2026-02-14T08:11:35.621122-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-tv7","title":"Migrate logging from JSONL to SQLite","description":"Replace the JSONL-based logging (src/log.ts) with SQLite INSERTs into the logs table. (1) appendLogEntry() inserts a row instead of appending to a file. (2) readLogEntries() queries the logs table with optional LIMIT. (3) Update tyr log subcommand to query SQLite (--last maps to LIMIT, --json returns rows as JSON). Remove --follow flag — polling a DB is not worth the complexity. (4) One-time migration: on first DB open, if log.jsonl exists, import all valid entries into the logs table, then delete the file. (5) The 'command' column is extracted from tool_input.command for Bash tools. Tests: insert and read round-trip, --last filtering, migration of existing JSONL, malformed JSONL lines skipped during migration.","status":"closed","priority":0,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-18T01:14:59.283283-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-18T02:02:31.129168-06:00","closed_at":"2026-02-18T02:02:31.129168-06:00","close_reason":"Migrated logging from JSONL to SQLite. appendLogEntry/readLogEntries now use SQLite. Migration imports existing JSONL then deletes the file. Removed --follow flag. All filters pushed to SQL. 51 tests across log.test.ts, log-cmd.test.ts, db.test.ts.","dependencies":[{"issue_id":"tyr-tv7","depends_on_id":"tyr-53y","type":"blocks","created_at":"2026-02-18T01:15:34.534162-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-w1b","title":"P4.5: Phase 4 E2E tests","description":"End-to-end tests for the full Phase 4 flow using the subprocess helper from P0.6: verify durable cache survives daemon restart (stop, start, check returns cached result), metrics accumulate across requests (cache hits, LLM checks, denials counted correctly), tyr stats outputs correct aggregates, tyr suggest produces reasonable recommendations based on decision history.\n\nDepends on: P0.6, P4.2, P4.4\nBlocks: nothing","status":"closed","priority":3,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T08:27:51.002628-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-18T01:15:41.746215-06:00","closed_at":"2026-02-18T01:15:41.746215-06:00","close_reason":"Replaced by SQLite Storage Layer epic (tyr-6fb). Daemon approach replaced with direct SQLite access.","dependencies":[{"issue_id":"tyr-w1b","depends_on_id":"tyr-bzs","type":"blocks","created_at":"2026-02-14T08:27:57.062587-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-w1b","depends_on_id":"tyr-1zm","type":"blocks","created_at":"2026-02-14T08:27:57.146889-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-w1b","depends_on_id":"tyr-hw1","type":"blocks","created_at":"2026-02-14T08:27:57.228221-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-wfg","title":"P1.2: Shell command parser","description":"Implement `src/providers/shell-parser.ts`. Integrate `sh-syntax` to parse a shell command string into an AST and extract the list of individual \"simple commands\" (handling pipes, `\u0026\u0026`, `||`, `;`, subshells, command substitution, redirections). Extensive unit tests for edge cases (quoted strings, nested subshells, redirections like `2\u003e\u00261`).\n\nTests: pipes, `\u0026\u0026`/`||`, `;`, subshells `(cmd1; cmd2)`, command substitution `$(cmd)`, quoted strings, redirections, nested combinations.\n\nDepends on: P0.1b\nBlocks: P1.3","notes":"## Findings: sh-syntax vs mvdan-sh\n\nsh-syntax (WASM port) has a broken AST for our use case. The Go WASM bridge's mapNode() only serializes Pos/End for Cmd nodes — all type-specific fields (Op, Args, Stmts, X/Y) are lost. Confirmed by intercepting raw WASM JSON output. parse/print work for reformatting, but the AST cannot be inspected for command structure (pipes, \u0026\u0026, ||, subshells).\n\nmvdan-sh (GopherJS port of same Go library) preserves the full AST. Verified CallExpr, BinaryCmd (op 10=\u0026\u0026, 11=||, 12=|), Subshell all come through with fields intact. It also exposes syntax.Walk() and syntax.NodeType(). No TS types shipped, but we can write a thin typed wrapper.\n\nRecommendation: use mvdan-sh. It's the same underlying parser with a JS compilation that preserves struct fields. The sh-syntax PLAN.md recommendation was based on incorrect assumptions about AST fidelity.","status":"closed","priority":1,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T08:11:33.415982-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-14T15:10:17.062539-06:00","closed_at":"2026-02-14T15:10:17.062539-06:00","close_reason":"Closed","dependencies":[{"issue_id":"tyr-wfg","depends_on_id":"tyr-bdv","type":"blocks","created_at":"2026-02-14T08:11:35.188741-06:00","created_by":"Rushy Panchal"}]}
{"id":"tyr-xdv","title":"Research: validate SQLite schema design","description":"Before any implementation, thoroughly validate the proposed SQLite schema in the epic (tyr-6fb) against all current and planned tyr functionality. Run bd show tyr-6fb to see the proposed schema and design decisions.\n\nCheck: (1) Every field in the current LogEntry type (src/log.ts) maps to a logs table column — nothing is dropped. (2) The cache key (tool_name, tool_input, cwd) covers all provider decision factors — are there edge cases where the same command in the same cwd should produce different results? (3) The config_hash approach is sufficient for invalidation — what exactly goes into the hash? Just Claude allow/deny rules, or also tyr's own config (llmModel, llmCanDeny, etc.)? (4) Index coverage for tyr stats queries (--since filtering) and tyr suggest queries (GROUP BY tool_input). (5) Whether permission_mode should be part of the cache key. (6) Whether session_id or any other PermissionRequest fields affect decisions. (7) Column types and CHECK constraints are correct. (8) Edge cases: empty tool_input, non-Bash tools, very long commands. Output: confirmed schema or proposed amendments with justification.","status":"closed","priority":0,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-18T01:17:32.438787-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-18T01:34:58.435585-06:00","closed_at":"2026-02-18T01:34:58.435585-06:00","close_reason":"Schema validated. Three amendments: (1) idx_logs_suggest changed to (decision, mode, tool_input) for suggest query. (2) config_hash must include tyr config, not just Claude rules. (3) Non-Bash tool_input extraction falls back to JSON.stringify. All updates applied to epic tyr-6fb and task tyr-52l."}
{"id":"tyr-yaw","title":"make providers an ordered array","description":"allow the config to specify providers as an ordered array, like providers: ['chained-commands', 'llm']. if any allows the check, it goes through","status":"open","priority":1,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-18T08:53:57.82351-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-18T08:53:57.82351-06:00"}
{"id":"tyr-yr0","title":"Remove unused AgentConfig interface","description":"In src/types.ts:48-54, AgentConfig interface is defined but never referenced anywhere. ClaudeAgent uses its own internal allow/deny arrays. Remove the dead code.","status":"closed","priority":4,"issue_type":"task","owner":"panchal.rushy@gmail.com","created_at":"2026-02-15T21:42:13.261369-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-15T22:21:50.729847-06:00","closed_at":"2026-02-15T22:21:50.729847-06:00","close_reason":"Closed"}
{"id":"tyr-zf9","title":"Phase 0.5: Permission Logging","description":"tyr check receives permission requests and logs them. Validates the hook integration works end-to-end.","status":"closed","priority":1,"issue_type":"epic","owner":"panchal.rushy@gmail.com","created_at":"2026-02-14T08:11:31.793002-06:00","created_by":"Rushy Panchal","updated_at":"2026-02-14T14:10:09.245917-06:00","closed_at":"2026-02-14T14:10:09.245917-06:00","close_reason":"Closed","dependencies":[{"issue_id":"tyr-zf9","depends_on_id":"tyr-33c","type":"blocks","created_at":"2026-02-14T08:12:32.530599-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-zf9","depends_on_id":"tyr-g33","type":"blocks","created_at":"2026-02-14T08:12:32.628212-06:00","created_by":"Rushy Panchal"},{"issue_id":"tyr-zf9","depends_on_id":"tyr-bh3","type":"blocks","created_at":"2026-02-14T08:12:32.711648-06:00","created_by":"Rushy Panchal"}]}
